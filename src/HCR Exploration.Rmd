---
title: "HCR Exploration"
author: "JGaun"
date: "2/9/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
```


#### Load the Data

Data from Erin January 2022

```{r load data and create factor levels for sites}
hcr_trends <- read_csv(here("data", "HCR_SummarizedResultsFinal_Jan2022.csv"))

#order sites from upstream to downstream
hcr_trends$siteName <- as.factor(hcr_trends$siteName)

factor(hcr_trends$siteName, levels = c("Pool4A", "Pool4B", "Pool5_6", "Pool8", "LD9", "LD11", "Pool13", "LD15", "LD17", "LD19", "LD21", "LD24", "Pool26", "OpenRiver", "J-36", "I-05", "LaGrange" ))

hcr_trends <- hcr_trends %>% 
  mutate(siteName = fct_relevel(siteName,"Pool4A", "Pool4B", "Pool5_6", "Pool8", "LD9", "LD11", "Pool13", "LD15", "LD17", "LD19", "LD21", "LD24", "Pool26", "OpenRiver", "J-36", "I-05", "LaGrange"))

head(hcr_trends)
```


```{r chloride}
#all chloride trends
chloride<- hcr_trends %>% 
  filter(parameter == "Chloride") %>%
  select(siteName, timePeriod, cDirection, cPercentChangeTotal, cAmtChangeTotal, cUnits, cTrendConfidence) 

#hgh confidence chloride trends
chloride_high <- hcr_trends %>% 
  filter(parameter == "Chloride") %>%
  select(siteName, timePeriod, cDirection, cPercentChangeTotal, cAmtChangeTotal, cUnits, cTrendConfidence) %>% 
  filter(cTrendConfidence =="high") 

#summary high confidence chloride trends
summary(chloride_high$cPercentChangeTotal)
summary(chloride_high$cAmtChangeTotal)

#summary all chloride trends
summary(chloride$cPercentChangeTotal)
summary(chloride$cAmtChangeTotal)

```

#### Nutrients
```{r nutrients}
 #all nutrient trends
nutrients<- hcr_trends %>% 
  filter(parameter == "Total Phosphorus"|
         parameter == "Total Nitrogen"|
         parameter == "Inorganic Nitrogen"|
         parameter == "Ammonia"|
         parameter == "Chlorophyll-a") %>%
  select(siteName, parameter, timePeriod, cDirection, cPercentChangeTotal, cAmtChangeTotal, cUnits, cTrendConfidence)

#Nitrogen 
nitrogen_all <- nutrients %>% 
  filter(parameter == "Total Nitrogen"|
         parameter == "Inorganic Nitrogen"|
         parameter == "Ammonia")

##Total Nitrogen
total_n<- nutrients %>% 
  filter(parameter == "Total Nitrogen")

tn_high <- total_n %>%
  filter(cTrendConfidence =="high")

## Inorganic Nitrogen 
inorg_n <- nutrients %>% 
  filter(parameter == "Inorganic Nitrogen")

inorg_n_high <- inorg_n %>%
  filter(cTrendConfidence =="high")

## Chlorophyll-a
chl<- nutrients %>% 
  filter(parameter == "Chlorophyll-a")

chl_high <- chl %>%
  filter(cTrendConfidence =="high")

##Total Phosphorus 
t_phos <- nutrients %>% 
  filter(parameter == "Total Phosphorus")

t_phos_high <- t_phos %>% 
  filter(cTrendConfidence == "high")

```

```{r ammonia}
##Ammonia 
ammonia <- nutrients %>% 
  filter(parameter == "Ammonia")

ggplot(ammonia, aes(x =siteName, y =cPercentChangeTotal))+
  geom_point(aes(color= cTrendConfidence))

###high confidence ammonia trends
ammonia_high <- ammonia %>%
  filter(cTrendConfidence =="high")

summary(ammonia_high$cPercentChangeTotal)
summary(ammonia_high$cAmtChangeTotal)
```

```{r metals}
 #all nutrient trends
metals<- hcr_trends %>% 
  filter(parameter == "Total Aluminum"|
         parameter == "Total Arsenic"|
         parameter == "Total Copper"|
         parameter == "Total Cadmium"|
         parameter == "Total Lead" |
         parameter == "Total Mercury") %>%
  select(siteName, parameter, timePeriod, cDirection, cPercentChangeTotal, cAmtChangeTotal, cUnits, cTrendConfidence) 

factor(metals$siteName, levels = c("Pool4A", "Pool4B", "Pool5_6", "Pool8", "LD9", "LD11", "Pool13", "LD15", "LD17", "LD19", "LD21", "LD24", "Pool26", "OpenRiver", "J-36", "I-05", "LaGrange" ))

#Aluminum 
metal_al<- metals%>% 
  filter(parameter == "Total Aluminum")

##Total Arsenic
metal_ar <- metals%>% 
  filter(parameter == "Total Arsenic")

## Total Copper
metal_cu<-metals%>% 
  filter(parameter == "Total Copper")

## Total Cadmium
metal_cd<-metals%>% 
  filter(parameter == "Total Cadmium")

## Total Lead
metal_pb<-metals%>% 
  filter(parameter == "Total Lead")

ggplot(metal_pb, aes(x =siteName, y =cAmtChangeTotal))+
  geom_point(aes(color= cTrendConfidence))


## Total Mercury
metal_hg <-  metals%>% 
  filter(parameter == "Total Mercury")

```


```{r}

```




